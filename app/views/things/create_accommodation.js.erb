<% if @thing.errors.any? %>
  // Render new review form with errors
  $('#new_thing').html('<%= j render "cities/new_accommodation_form" %>')
<% else %>
  // Add it to the DOM, at the end of the existing reviews. It's still hidden.
  var new_card = $('<%= j render "shared/selection_card", thing: @thing %>').hide();
  if ($("#accommodation1>div").attr("class") == "empty_selection"){
    $('#accommodation1').html('');
    $('#accommodation1').append(new_card);
    new_card.fadeIn();
  } else if ($("#accommodation2>div").attr("class") == "empty_selection"){
    $('#accommodation2').html('');
    $('#accommodation2').append(new_card);
    new_card.fadeIn();
  } else if ($("#accommodation3>div").attr("class") == "empty_selection"){
    $('#accommodation3').html('');
    $('#accommodation3').append(new_card);
    new_card.fadeIn();
  } else {
    var new_card1 = $($('#accommodation2').html()).hide();
    var new_card2 = $($('#accommodation3').html()).hide();
    $('#accommodation1').html('');
    $('#accommodation1').append(new_card1);
    $('#accommodation2').html('');
    $('#accommodation2').append(new_card2);
    $('#accommodation3').html('');
    $('#accommodation3').append(new_card);
    new_card1.fadeIn();
    new_card2.fadeIn();
    new_card.fadeIn();
    $('#new_thing_modal').modal("hide");
  }
<% end %>
