<% if @thing.errors.any? %>
  // Render new review form with errors
  $('#new_thing').html('<%= j render "cities/new_bar_form" %>')
<% else %>
  // Add it to the DOM, at the end of the existing reviews. It's still hidden.
  var new_card = $('<%= j render "shared/selection_card", thing: @thing %>').hide();
  if ($("#bar1>div").attr("class") == "empty_selection"){
    $('#bar1').html('');
    $('#bar1').append(new_card);
    new_card.fadeIn();
  } else if ($("#bar2>div").attr("class") == "empty_selection"){
    $('#bar2').html('');
    $('#bar2').append(new_card);
    new_card.fadeIn();
  } else if ($("#bar3>div").attr("class") == "empty_selection"){
    $('#bar3').html('');
    $('#bar3').append(new_card);
    new_card.fadeIn();
  } else {
    var new_card1 = $($('#bar2').html()).hide();
    var new_card2 = $($('#bar3').html()).hide();
    $('#bar1').html('');
    $('#bar1').append(new_card1);
    $('#bar2').html('');
    $('#bar2').append(new_card2);
    $('#bar3').html('');
    $('#bar3').append(new_card);
    new_card1.fadeIn();
    new_card2.fadeIn();
    new_card.fadeIn();
    $('#new_thing_modal').modal("hide");
  }
<% end %>
